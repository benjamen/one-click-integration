var m=(f,d,n)=>new Promise((p,g)=>{var o=s=>{try{c(n.next(s))}catch(r){g(r)}},a=s=>{try{c(n.throw(s))}catch(r){g(r)}},c=s=>s.done?p(s.value):Promise.resolve(s.value).then(o,a);c((n=n.apply(f,d)).next())});import{b0 as E,f as u,c as v}from"./vendor-D4UtxinR.js";import{j as J}from"./frappe-ui-BJqOB8bf.js";const L=E("onboarding",()=>{const d=(()=>{try{const e=localStorage.getItem("lodgeick_onboarding");if(e)return JSON.parse(e)}catch(e){console.error("Failed to load persisted onboarding state:",e)}return{currentStep:1,connectedApps:[],selectedIntegrations:[],fieldMappings:{}}})(),n=u(d.currentStep||1),p=u(2),g=u(!1),o=u(d.connectedApps||[]),a=u(d.selectedIntegrations||[]),c=u(d.fieldMappings||{}),s=u(!1),r=u([]),i=()=>{try{localStorage.setItem("lodgeick_onboarding",JSON.stringify({currentStep:n.value,connectedApps:o.value,selectedIntegrations:a.value,fieldMappings:c.value}))}catch(e){console.error("Failed to persist onboarding state:",e)}},b=v(()=>n.value/p.value*100),S=v(()=>{switch(n.value){case 1:return o.value.length>0;case 2:return!0;default:return!1}}),_=v(()=>o.value.length>0);function h(){return m(this,null,function*(){if(!(r.value.length>0)){s.value=!0;try{const e=yield J("lodgeick.api.catalog.get_app_catalog");e.success&&e.apps&&(r.value=e.apps.map(t=>({id:t.app_name,name:t.display_name||t.app_name,description:t.description,icon:y(t.app_name),color:A(t.category),logo_url:t.logo_url,category:t.category,oauth_provider:t.oauth_provider,isConnected:o.value.includes(t.app_name),use_cases:t.use_cases||[]})))}catch(e){console.error("Failed to load apps:",e),console.error("Error details:",e)}finally{s.value=!1}}})}function y(e){return{jira:"ğŸ¯",slack:"ğŸ’¬",hubspot:"ğŸ¨",google_sheets:"ğŸ“Š",salesforce:"â˜ï¸",mailchimp:"âœ‰ï¸",xero:"ğŸ’¼"}[e]||"ğŸ”Œ"}function A(e){return{CRM:"bg-orange-500",Communication:"bg-purple-500",Productivity:"bg-green-500",Finance:"bg-blue-600",Marketing:"bg-yellow-500","Project Management":"bg-blue-500"}[e]||"bg-gray-500"}function C(e){n.value=e,i()}function M(){n.value<p.value&&(n.value++,i())}function k(){n.value>1&&(n.value--,i())}function I(e){const t=r.value.find(l=>l.id===e);t&&!t.isConnected&&(t.isConnected=!0,o.value.includes(e)||o.value.push(e),i())}function F(e){const t=r.value.find(l=>l.id===e);t&&(t.isConnected=!1,o.value=o.value.filter(l=>l!==e),a.value=a.value.filter(l=>!l.includes(e)),i())}function O(e,t){const l=`${e}-${t}`;a.value.includes(l)||(a.value.push(l),i())}function P(e){a.value=a.value.filter(t=>t!==e),i()}function j(e,t){c.value[e]=t,i()}function w(){g.value=!0,localStorage.removeItem("lodgeick_onboarding"),n.value=1}function x(){n.value=1,g.value=!1,o.value=[],a.value=[],c.value={},r.value.forEach(e=>{e.isConnected=!1}),localStorage.removeItem("lodgeick_onboarding")}return{currentStep:n,totalSteps:p,isCompleted:g,connectedApps:o,selectedIntegrations:a,fieldMappings:c,availableApps:r,isLoadingApps:s,progress:b,canContinue:S,hasConnectedApps:_,loadApps:h,setStep:C,nextStep:M,previousStep:k,connectApp:I,disconnectApp:F,addIntegration:O,removeIntegration:P,saveFieldMapping:j,completeOnboarding:w,resetOnboarding:x}});export{L as u};
//# sourceMappingURL=onboarding-CmB3XiJu.js.map
