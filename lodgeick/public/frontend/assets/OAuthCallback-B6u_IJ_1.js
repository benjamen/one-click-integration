var f=(v,n,c)=>new Promise((o,i)=>{var r=e=>{try{t(c.next(e))}catch(a){i(a)}},u=e=>{try{t(c.throw(e))}catch(a){i(a)}},t=e=>e.done?o(e.value):Promise.resolve(e.value).then(r,u);t((c=c.apply(v,n)).next())});import{_ as m,c as b,j as g}from"./frappe-ui-BJqOB8bf.js";import{aZ as y,F as _,f as p,af as x,a as l,o as d,b as s,e as k,aF as w,t as C,u as A}from"./vendor-D4UtxinR.js";const F={class:"oauth-callback-page flex items-center justify-center min-vh-100 bg-gradient-dark"},O={class:"container"},B={class:"flex justify-center"},R={class:"col-md-6"},S={class:"card shadow-lg"},j={class:"card-body p-5 text-center"},N={key:0},P={key:1},V={key:2},q={class:"text-gray-600 mb-4"},z={__name:"OAuthCallback",setup(v){const n=y(),c=_(),o=p(!0),i=p(!1),r=p(null),u=b({url:"lodgeick.api.oauth.oauth_callback",makeParams(t){return{code:t.code,state:t.state,provider:t.provider}},onSuccess(t){o.value=!1,i.value=!0,setTimeout(()=>{c.push("/integrate")},2e3)},onError(t){o.value=!1,r.value=t.message||"Failed to complete OAuth flow"}});return x(()=>f(this,null,function*(){const t=n.query.code,e=n.query.state;if(!t||!e){o.value=!1,r.value="Missing OAuth parameters (code or state)";return}try{const a=yield g("lodgeick.api.oauth.get_provider_from_state",{state:e});if(!a||!a.provider){o.value=!1,r.value="Could not retrieve provider from state";return}const h=a.provider;u.submit({code:t,state:e,provider:h})}catch(a){o.value=!1,r.value=a.message||"Failed to retrieve OAuth state"}})),(t,e)=>(d(),l("div",F,[s("div",O,[s("div",B,[s("div",R,[s("div",S,[s("div",j,[o.value?(d(),l("div",N,[...e[1]||(e[1]=[s("div",{class:"spinner-border text-primary mb-3",style:{width:"3rem",height:"3rem"},role:"status"},[s("span",{class:"visually-hidden"},"Processing...")],-1),s("h4",{class:"font-bold mb-2"},"Connecting your account",-1),s("p",{class:"text-gray-600"},"Please wait while we complete the authentication...",-1)])])):i.value?(d(),l("div",P,[...e[2]||(e[2]=[w('<div class="icon icon-shape bg-gradient-success shadow-success mx-auto mb-4" style="width:80px;height:80px;" data-v-d2f3baa2><i class="fas fa-check text-white" style="font-size:2rem;" data-v-d2f3baa2></i></div><h4 class="font-bold mb-2" data-v-d2f3baa2>Successfully Connected!</h4><p class="text-gray-600 mb-4" data-v-d2f3baa2>Your account has been linked successfully.</p><p class="text-sm text-gray-600" data-v-d2f3baa2>Redirecting you back...</p>',4)])])):r.value?(d(),l("div",V,[e[3]||(e[3]=s("div",{class:"icon icon-shape bg-gradient-danger shadow-danger mx-auto mb-4",style:{width:"80px",height:"80px"}},[s("i",{class:"fas fa-times text-white",style:{"font-size":"2rem"}})],-1)),e[4]||(e[4]=s("h4",{class:"font-bold mb-2"},"Connection Failed",-1)),s("p",q,C(r.value),1),s("button",{onClick:e[0]||(e[0]=a=>A(c).push("/integrate")),class:"btn btn-primary"}," Go Back ")])):k("",!0)])])])])])]))}},G=m(z,[["__scopeId","data-v-d2f3baa2"]]);export{G as default};
//# sourceMappingURL=OAuthCallback-B6u_IJ_1.js.map
