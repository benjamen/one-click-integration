{"version":3,"file":"onboarding-BZ6Xluvx.js","sources":["../../../../frontend/src/stores/onboarding.js"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport { ref, computed } from 'vue'\r\nimport { call } from 'frappe-ui'\r\n\r\nexport const useOnboardingStore = defineStore('onboarding', () => {\r\n  // State\r\n  const currentStep = ref(1)\r\n  const totalSteps = ref(4)\r\n  const isCompleted = ref(false)\r\n  const connectedApps = ref([])\r\n  const selectedIntegrations = ref([])\r\n  const fieldMappings = ref({})\r\n  const isLoadingApps = ref(false)\r\n\r\n  // Available apps for integration (loaded from backend)\r\n  const availableApps = ref([])\r\n\r\n  // Computed\r\n  const progress = computed(() => (currentStep.value / totalSteps.value) * 100)\r\n  const canContinue = computed(() => {\r\n    switch (currentStep.value) {\r\n      case 1: // Auth - handled by route guard\r\n        return true\r\n      case 2: // Connect Apps\r\n        return connectedApps.value.length > 0\r\n      case 3: // Integration\r\n        return selectedIntegrations.value.length > 0\r\n      case 4: // Configuration\r\n        return true // Can always skip\r\n      default:\r\n        return false\r\n    }\r\n  })\r\n\r\n  const hasConnectedApps = computed(() => connectedApps.value.length > 0)\r\n\r\n  // Actions\r\n  async function loadApps() {\r\n    if (availableApps.value.length > 0) return // Already loaded\r\n\r\n    isLoadingApps.value = true\r\n    try {\r\n      const response = await call('lodgeick.api.catalog.get_app_catalog')\r\n\r\n      if (response.success && response.apps) {\r\n        availableApps.value = response.apps.map(app => ({\r\n          id: app.app_name,\r\n          name: app.display_name || app.app_name,\r\n          description: app.description,\r\n          icon: getAppIcon(app.app_name),\r\n          color: getAppColor(app.category),\r\n          logo_url: app.logo_url,\r\n          category: app.category,\r\n          oauth_provider: app.oauth_provider,\r\n          isConnected: false,\r\n          use_cases: app.use_cases || []\r\n        }))\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load apps:', error)\r\n    } finally {\r\n      isLoadingApps.value = false\r\n    }\r\n  }\r\n\r\n  function getAppIcon(appName) {\r\n    const icons = {\r\n      'jira': 'üéØ',\r\n      'slack': 'üí¨',\r\n      'hubspot': 'üé®',\r\n      'google_sheets': 'üìä',\r\n      'salesforce': '‚òÅÔ∏è',\r\n      'mailchimp': '‚úâÔ∏è',\r\n      'xero': 'üíº',\r\n    }\r\n    return icons[appName] || 'üîå'\r\n  }\r\n\r\n  function getAppColor(category) {\r\n    const colors = {\r\n      'CRM': 'bg-orange-500',\r\n      'Communication': 'bg-purple-500',\r\n      'Productivity': 'bg-green-500',\r\n      'Finance': 'bg-blue-600',\r\n      'Marketing': 'bg-yellow-500',\r\n      'Project Management': 'bg-blue-500',\r\n    }\r\n    return colors[category] || 'bg-gray-500'\r\n  }\r\n\r\n  function setStep(step) {\r\n    currentStep.value = step\r\n  }\r\n\r\n  function nextStep() {\r\n    if (currentStep.value < totalSteps.value) {\r\n      currentStep.value++\r\n    }\r\n  }\r\n\r\n  function previousStep() {\r\n    if (currentStep.value > 1) {\r\n      currentStep.value--\r\n    }\r\n  }\r\n\r\n  function connectApp(appId) {\r\n    const app = availableApps.value.find(a => a.id === appId)\r\n    if (app && !app.isConnected) {\r\n      app.isConnected = true\r\n      connectedApps.value.push(appId)\r\n    }\r\n  }\r\n\r\n  function disconnectApp(appId) {\r\n    const app = availableApps.value.find(a => a.id === appId)\r\n    if (app) {\r\n      app.isConnected = false\r\n      connectedApps.value = connectedApps.value.filter(id => id !== appId)\r\n      selectedIntegrations.value = selectedIntegrations.value.filter(\r\n        integration => !integration.includes(appId)\r\n      )\r\n    }\r\n  }\r\n\r\n  function addIntegration(fromApp, toApp) {\r\n    const integrationKey = `${fromApp}-${toApp}`\r\n    if (!selectedIntegrations.value.includes(integrationKey)) {\r\n      selectedIntegrations.value.push(integrationKey)\r\n    }\r\n  }\r\n\r\n  function removeIntegration(integrationKey) {\r\n    selectedIntegrations.value = selectedIntegrations.value.filter(\r\n      key => key !== integrationKey\r\n    )\r\n  }\r\n\r\n  function saveFieldMapping(integrationKey, mapping) {\r\n    fieldMappings.value[integrationKey] = mapping\r\n  }\r\n\r\n  function completeOnboarding() {\r\n    isCompleted.value = true\r\n    // Reset for next time if needed\r\n    currentStep.value = 1\r\n  }\r\n\r\n  function resetOnboarding() {\r\n    currentStep.value = 1\r\n    isCompleted.value = false\r\n    connectedApps.value = []\r\n    selectedIntegrations.value = []\r\n    fieldMappings.value = {}\r\n    availableApps.value.forEach(app => {\r\n      app.isConnected = false\r\n    })\r\n  }\r\n\r\n  return {\r\n    // State\r\n    currentStep,\r\n    totalSteps,\r\n    isCompleted,\r\n    connectedApps,\r\n    selectedIntegrations,\r\n    fieldMappings,\r\n    availableApps,\r\n    isLoadingApps,\r\n\r\n    // Computed\r\n    progress,\r\n    canContinue,\r\n    hasConnectedApps,\r\n\r\n    // Actions\r\n    loadApps,\r\n    setStep,\r\n    nextStep,\r\n    previousStep,\r\n    connectApp,\r\n    disconnectApp,\r\n    addIntegration,\r\n    removeIntegration,\r\n    saveFieldMapping,\r\n    completeOnboarding,\r\n    resetOnboarding,\r\n  }\r\n})\r\n"],"names":["useOnboardingStore","defineStore","currentStep","ref","totalSteps","isCompleted","connectedApps","selectedIntegrations","fieldMappings","isLoadingApps","availableApps","progress","computed","canContinue","hasConnectedApps","loadApps","__async","response","call","app","getAppIcon","getAppColor","error","appName","category","setStep","step","nextStep","previousStep","connectApp","appId","a","disconnectApp","id","integration","addIntegration","fromApp","toApp","integrationKey","removeIntegration","key","saveFieldMapping","mapping","completeOnboarding","resetOnboarding"],"mappings":"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"}