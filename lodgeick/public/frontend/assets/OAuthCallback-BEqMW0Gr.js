var v=(m,i,a)=>new Promise((l,o)=>{var d=e=>{try{t(a.next(e))}catch(c){o(c)}},u=e=>{try{t(a.throw(e))}catch(c){o(c)}},t=e=>e.done?l(e.value):Promise.resolve(e.value).then(d,u);t((a=a.apply(m,i)).next())});import{_ as f,c as _,j as b}from"./frappe-ui-COa4gyPY.js";import{a$ as g,f as h,af as y,a as r,o as n,b as s,e as w,aF as x,t as k}from"./vendor-BOTW4f6D.js";const C={class:"oauth-callback-page flex items-center justify-center min-vh-100 bg-gradient-dark"},A={class:"container"},O={class:"flex justify-center"},F={class:"col-md-6"},S={class:"card shadow-lg"},j={class:"card-body p-5 text-center"},B={key:0},N={key:1},P={key:2},V={class:"text-gray-600 mb-4"},q={__name:"OAuthCallback",setup(m){const i=g(),a=h(!0),l=h(!1),o=h(null),d=_({url:"lodgeick.api.oauth.oauth_callback",makeParams(t){return{code:t.code,state:t.state,provider:t.provider}},onSuccess(t){a.value=!1,l.value=!0,setTimeout(()=>{window.close()},2e3)},onError(t){a.value=!1,o.value=t.message||"Failed to complete OAuth flow"}});y(()=>v(this,null,function*(){const t=i.query.code,e=i.query.state;if(!t||!e){a.value=!1,o.value="Missing OAuth parameters (code or state)";return}try{const c=yield b("lodgeick.api.oauth.get_provider_from_state",{state:e});if(!c||!c.provider){a.value=!1,o.value="Could not retrieve provider from state";return}const p=c.provider;d.submit({code:t,state:e,provider:p})}catch(c){a.value=!1,o.value=c.message||"Failed to retrieve OAuth state"}}));function u(){window.close()}return(t,e)=>(n(),r("div",C,[s("div",A,[s("div",O,[s("div",F,[s("div",S,[s("div",j,[a.value?(n(),r("div",B,[...e[0]||(e[0]=[s("div",{class:"spinner-border text-primary mb-3",style:{width:"3rem",height:"3rem"},role:"status"},[s("span",{class:"visually-hidden"},"Processing...")],-1),s("h4",{class:"font-bold mb-2"},"Connecting your account",-1),s("p",{class:"text-gray-600"},"Please wait while we complete the authentication...",-1)])])):l.value?(n(),r("div",N,[...e[1]||(e[1]=[x('<div class="icon icon-shape bg-gradient-success shadow-success mx-auto mb-4" style="width:80px;height:80px;" data-v-6803cd63><i class="fas fa-check text-white" style="font-size:2rem;" data-v-6803cd63></i></div><h4 class="font-bold mb-2" data-v-6803cd63>Successfully Connected!</h4><p class="text-gray-600 mb-4" data-v-6803cd63>Your account has been linked successfully.</p><p class="text-sm text-gray-600" data-v-6803cd63>This window will close automatically...</p>',4)])])):o.value?(n(),r("div",P,[e[2]||(e[2]=s("div",{class:"icon icon-shape bg-gradient-danger shadow-danger mx-auto mb-4",style:{width:"80px",height:"80px"}},[s("i",{class:"fas fa-times text-white",style:{"font-size":"2rem"}})],-1)),e[3]||(e[3]=s("h4",{class:"font-bold mb-2"},"Connection Failed",-1)),s("p",V,k(o.value),1),s("button",{onClick:u,class:"btn btn-primary"}," Close Window ")])):w("",!0)])])])])])]))}},R=f(q,[["__scopeId","data-v-6803cd63"]]);export{R as default};
//# sourceMappingURL=OAuthCallback-BEqMW0Gr.js.map
